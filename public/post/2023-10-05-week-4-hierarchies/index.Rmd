---
title: 'Week 4: Hierarchies'
author: Annelies Quinton
date: '2023-10-05'
slug: []
categories: []
tags: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
library(dplyr) # filter(), group_by(), summarize
library(readr) # read_csv()
library(ggplot2) # ggplot()
library(estimatr) # difference_in_means()
library(stargazer)
```

```{r, include = FALSE}
## read in data
sdo <- read_csv("sdo_data.csv")
# summary(sdo)
```

## add qualtrics photo

## Introduction:

## Data:

The data used in this blog is a condensed version of survey conducted and generated by [Data for Progress](%5Bhttps://wthh.dataforprogress.org/get-the-data) in 2018. The data includes 3,144 rows (individuals) and 15 columns. The variables are primarily categorical variables, measuring the individuals' position on different questions with political undertones. The data also includes demographic variables such as race, education, sex, and age. The variables used in this blog are included below:

| Variable Name | Variable Description                                                                                                                                            |
|----------------|--------------------------------------------------------|
| `sdo5`        | Five-point social dominance orientation (SDO) scale: 1. Minimum SDO; ...; 5. Maximum SDO                                                                        |
| `female`      | Indicator for whether or not the respondent is female. Coded 1 if respondent is female, 0 otherwise.                                                            |
| `birthyr`     | Respondent's birth year                                                                                                                                         |
| `educ`        | Education: 1. Didn't graduate HS; 2. HS graduate; 3. Some college; 4. 2-year college; 5. 4-year college; 6. Postgraduate                                        |
| `race`        | Race: 1. White; 2. Black or African-American; 3. Hispanic or Latino; 4. Asian or Asian-American; 5. Native American; 6. Mixed Race; 7. Other; 8. Middle Eastern |
| `favor_trump` | Favorability of Donald Trump: 1. very unfavorable; ...; 4. very favorable                                                                                       |
| `favor_blm`   | Favorability of Black Lives Matter: 1. very unfavorable; ...; 4. very favorable                                                                                 |
| `favor_metoo` | Favorability of the Me Too movement: 1. very unfavorable; ...; 4. very favorable                                                                                |
| `pid3`        | Three-category party identification: 1. Democrat; 2. Independent; 3. Republican                                                                                 |
| `ideo5`       | Five-category political ideology: 1. Very liberal; ...; 5. Very conservative                                                                                    |
| `presvote16`  | Vote choice in the 2016 presidential election                                                                                                                   |
## Social Dominance Orientation

```{r, echo = FALSE}
ggplot(sdo, aes(x=sdo5)) +
  geom_density() +
  geom_vline(xintercept = mean(sdo$sdo5), color="blue") +
  geom_vline(xintercept = median(sdo$sdo5), color="red")
```


```{r, echo=FALSE}
sdo_no_na <- sdo %>%
  filter(!is.na(pid3)) %>%
  mutate(pid3 = case_when(pid3 == 1 ~ "Democrat",
                          pid3 == 2 ~ "Independent",
                          pid3 == 3 ~ "Republican")) %>%
  ggplot(aes(x=sdo5)) +
  geom_density() +
  facet_wrap(~pid3) +
  labs(title = "Density Plot of Each Party Affiliation (Pid3)", x = "Five-point social dominance orientation (sdo5)", y = "Density")

sdo_no_na
```
```{r, message=FALSE,warning=FALSE, echo=FALSE}
sdo_stacked_bar <- sdo %>% 
  group_by(sdo5, favor_trump) %>% # First we'll create counts for each group
  summarise(number_cases = n()) %>% 
  group_by(sdo5) %>% # Group new datafram by class
  mutate(total_cases = sum(number_cases),
         proportion = number_cases/total_cases)

ggplot(sdo_stacked_bar, aes(x=sdo5, y=favor_trump)) + 
  geom_point(aes(size=proportion)) +
  labs(title = "Relationship Between Trump Favorability and SDO", 
       subtitle = "Proportion of Individuals at Each Trump Level among SDO5 Category") +
  ylab("Trump Favorability (0-4)") +
  xlab("SDO5") 
  
```


## Fitting a Model:

```{r, results='asis'}
# data for progress is left
sdo <- sdo %>%
  mutate(white = case_when(race == 1 ~1,
                            T ~ 0),# all other cases
        rep_votes = case_when(presvote16 == "Trump" ~ 1,
                              presvote16 %in% c("Clinton", "Johnson", "McMullin", "Other", "Stein") ~ 0,
                              presvote16 == "Did not vote" ~ NA_real_))

fit1 <- lm(rep_votes ~ sdo5 + female + white + educ + age + pid3 + ideo5, sdo)
fit2 <- lm(rep_votes ~ sdo5 + white + educ + age + pid3 + ideo5, sdo)
fit3 <- lm(rep_votes ~ white + educ + age, sdo)
fit4 <- lm(rep_votes ~ sdo5, sdo)

stargazer(fit4, fit3, fit2, fit1, title="Regression Results", type='html',
          dep.var.labels = "Republican Votes",
          covariate.labels=c("SDO5 [sdo5]", "Gender [female]", "Race [white]", "Education [educ]", "Age [age]", "Party ID [pid3]", "Ideology [ideo5]"),
          omit.stat = c("f", "ser"),
          out="output.tex")
```

To evaluate the

<!-- $$ -->

<!-- rep_vote = \beta_0 + \beta_1sdo5 + \beta_2female + \beta_3white + \beta_4educ +  \beta_5age + \beta_6pid3 + \beta_7ideo5 + \epsilon -->

<!-- $$ -->
